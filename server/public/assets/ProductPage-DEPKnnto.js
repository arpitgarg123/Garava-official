import{j as e,u as F,r as h,s as j,a as P,f as L,b as E,c as A,d as R,B as $,P as _,e as B,g as T}from"./index-CKwcYcCo.js";import{P as H}from"./ProductCard-BcMQ8msZ.js";import"./index-CFYhMnPX.js";const W=({value:r={min:"",max:""},onChange:y=()=>{},isMobile:s=!1,heading:n})=>{const t=(l,i)=>{const c=i.target.value;(c===""||/^\d*$/.test(c))&&y({...r,[l]:c})};return s?e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium mb-3",children:n||"Price Range"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"mobile-min-price",className:"block text-sm text-gray-600 mb-1",children:"Min Price"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"₹"}),e.jsx("input",{type:"text",id:"mobile-min-price",inputMode:"numeric",pattern:"[0-9]*",value:r.min,onChange:l=>t("min",l),className:"w-full pl-8 pr-3 py-2 border rounded-md",placeholder:"0"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"mobile-max-price",className:"block text-sm text-gray-600 mb-1",children:"Max Price"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"₹"}),e.jsx("input",{type:"text",id:"mobile-max-price",inputMode:"numeric",pattern:"[0-9]*",value:r.max,onChange:l=>t("max",l),className:"w-full pl-8 pr-3 py-2 border rounded-md",placeholder:"100000"})]})]})]})]}):e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Price Range"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"min-price",className:"block text-sm text-gray-600 mb-1",children:"Min Price"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"₹"}),e.jsx("input",{type:"text",id:"min-price",inputMode:"numeric",pattern:"[0-9]*",value:r.min,onChange:l=>t("min",l),className:"w-full pl-8 pr-3 py-2 border rounded-md",placeholder:"0"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"max-price",className:"block text-sm text-gray-600 mb-1",children:"Max Price"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"₹"}),e.jsx("input",{type:"text",id:"max-price",inputMode:"numeric",pattern:"[0-9]*",value:r.max,onChange:l=>t("max",l),className:"w-full pl-8 pr-3 py-2 border rounded-md",placeholder:"100000"})]})]})]})]})},O=({selected:r,onChange:y,categories:s,counts:n={},isMobile:t=!1})=>{const l=i=>{y(i)};return t?e.jsxs("div",{className:"mb-2",children:[e.jsx("h3",{className:"text-base font-medium mb-3",children:"Categories"}),e.jsx("div",{className:"space-y-2",children:s.map(i=>{const c=r===i.id;let g=i.id;i.id.startsWith("all-")&&(g="__all");const x=n[g],f=typeof x=="number"?x:0;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:`mobile-cat-${i.id}`,name:"mobile-category",className:"h-4 w-4 border-gray-300 text-black focus:ring-black",checked:c,onChange:()=>l(i.id)}),e.jsx("label",{htmlFor:`mobile-cat-${i.id}`,className:"ml-2 text-sm font-medium",children:i.label})]}),e.jsx("span",{className:"text-xs text-gray-500",children:f})]},i.id)})})]}):e.jsxs("div",{"aria-labelledby":"category-filter",children:[e.jsx("h3",{id:"category-filter",className:"text-lg font-medium text-gray-900 mb-3",children:"Filter By Product Categories"}),e.jsx("ul",{className:"space-y-2",children:s.map(i=>{const c=r===i.id;let g=i.id;i.id.startsWith("all-")&&(g="__all");const x=n[g],f=typeof x=="number"?x:0;return e.jsx("li",{children:e.jsxs("button",{onClick:()=>l(i.id),className:`w-full flex items-center justify-between text-left px-2 py-2 rounded-md transition ${c?"bg-black text-white":"text-gray-700 hover:bg-gray-50"}`,"aria-pressed":c,children:[e.jsx("span",{className:"text-sm",children:i.label}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${c?"bg-white text-black":"bg-gray-100 text-gray-600"}`,children:f})]})},i.id)})})]})},U=[{key:"rose",label:"Rose Gold",hex:"#e7b9a4"},{key:"silver",label:"Silver",hex:"#d9d9d9"},{key:"gold",label:"Golden",hex:"#c79b3a"}],G=({selected:r=[],onChange:y=()=>{}})=>{const s=n=>{r.includes(n)?y(r.filter(t=>t!==n)):y([...r,n])};return e.jsxs("div",{"aria-labelledby":"color-filter",children:[e.jsx("h3",{id:"color-filter",className:"text-lg font-medium text-gray-900 mb-3",children:"Color"}),e.jsx("div",{className:"flex flex-col items-start justify-start ",children:U.map(n=>{const t=r.includes(n.key);return e.jsxs("button",{onClick:()=>s(n.key),className:`flex w-32 items-start self-start px-2 py-2  rounded-md text-sm transition focus:outline-none ${t?"bg-black text-white":"bg-white text-gray-800 hover:bg-gray-50"}`,"aria-pressed":t,children:[e.jsx("span",{"aria-hidden":"true",className:"inline-block w-5 h-5 rounded-full border",style:{background:n.hex,borderColor:t?"#fff":"#e5e7eb"}}),e.jsx("span",{children:n.label})]},n.key)})})]})},J=[{id:"all-jewellery",label:"All Jewellery"},{id:"rings",label:"Rings"},{id:"necklaces",label:"Necklaces"},{id:"earrings",label:"Earrings"},{id:"pendants",label:"Pendants"}],z=[{id:"all-fragrance",label:"All Fragrance"},{id:"women",label:"For Women"},{id:"men",label:"For Men"},{id:"unisex",label:"Unisex"},{id:"gift-sets",label:"Gift Sets"}],k=({mainCategory:r="jewellery",onFilterChange:y=()=>{},isMobile:s=!1,initialValues:n={}})=>{const t=F(),[l,i]=h.useState({min:n.priceMin||"",max:n.priceMax||""}),[c,g]=h.useState(n.category||""),[x,f]=h.useState([]),d=(r||"jewellery").toLowerCase(),b=d==="jewellery"?J:z;h.useEffect(()=>{var m;!c&&b.length>0&&g(((m=b[0])==null?void 0:m.id)||null),d!=="jewellery"&&f([])},[d]),h.useEffect(()=>{if(s)y({type:d,category:c,priceMin:l.min?Number(l.min):null,priceMax:l.max?Number(l.max):null});else if(c){const m={type:d,category:c,priceMin:l.min?Number(l.min):null,priceMax:l.max?Number(l.max):null,page:1};m.category&&m.category.startsWith("all-")&&(m.category=""),t(j(m))}},[c,l,x,s]);const p=P(m=>m.product.categoryCounts[d]||{});h.useEffect(()=>{if(!d||p&&Object.keys(p).length>0)return;const m=setTimeout(()=>{const w=b.map(N=>N.id);t(L({type:d,categories:w}))},300);return()=>clearTimeout(m)},[d,p,t]);const o=e.jsxs(e.Fragment,{children:[e.jsx("div",{className:s?"mb-6":"",children:e.jsx(O,{selected:c,onChange:g,categories:b,counts:p,isMobile:s})}),s&&e.jsx("hr",{className:"my-6"}),e.jsx("div",{className:s?"mb-6":"",children:e.jsx(W,{value:l,onChange:i,isMobile:s,heading:s?"Price Range":void 0})}),d==="jewellery"&&e.jsxs(e.Fragment,{children:[s&&e.jsx("hr",{className:"my-6"}),e.jsx("div",{className:s?"mb-6":"",children:e.jsx(G,{selected:x,onChange:f,isMobile:s,heading:s?"Metal Color":void 0})})]})]});return s?o:e.jsx("aside",{className:"sticky top-20 w-full max-w-[280px] mb-6",children:e.jsx("div",{className:"bg-white",children:e.jsx("div",{className:"space-y-6 pr-4",children:o})})})},X=()=>{const r=F(),y=E(),{category:s}=A(),{list:n,filters:t}=P(a=>a.product),{items:l,status:i,error:c}=n,[g,x]=h.useState(!1),[f,d]=h.useState(null),p=new URLSearchParams(y.search).get("subcategory");h.useEffect(()=>{if(!s)return;const a=s.toLowerCase();if(a==="all"){r(j({type:"",category:"",page:1}));return}if(p&&p!=="all"){r(j({type:a,category:p,page:1}));return}if(a.startsWith("all-"))r(j({type:a.replace("all-",""),category:"",page:1}));else if(a==="jewellery"||a==="fragrance"||a==="high-jewellery")r(j({type:a,category:"",page:1}));else{const u=t.type||"jewellery";r(j({type:u,category:a,page:1}))}},[s,p,r]);const[o,m]=h.useState(t);h.useEffect(()=>{m(t)},[t]),h.useEffect(()=>{const a=setTimeout(()=>{const u={page:o.page,limit:o.limit,sort:o.sort};o.type&&(u.type=o.type),o.category&&(u.category=o.category),o.priceMin!=null&&(u.priceMin=o.priceMin),o.priceMax!=null&&(u.priceMax=o.priceMax),r(R(u))},200);return()=>clearTimeout(a)},[o,r]);const N=(()=>{const a=s==null?void 0:s.toLowerCase();return a==="all"?"All Products":p&&p!=="all"?`${s==="high-jewellery"?"High Jewellery":s} - ${p.replace(/-/g," ")}`:a==="high-jewellery"?"High Jewellery Collection":s?s.replace(/-/g," "):t.type||"products"})(),S=()=>{f&&(r(j(f)),d(null)),x(!1)},M=a=>{d(u=>({...u||t,...a}))},v=()=>{d(null),x(!1)},C=()=>(s==null?void 0:s.toLowerCase())==="all"?"all":t.type||s||"jewellery";return e.jsxs("div",{className:"w-full py-6 mt-20 max-md:mt-0 relative",children:[e.jsx("div",{className:"sticky top-16 z-10 mt-4",children:e.jsx($,{})}),e.jsx(_,{title:N}),e.jsxs("div",{className:"w-full max-w-7xl mx-auto px-2 sm:px-4 md:px-6 lg:px-0",children:[e.jsx("div",{className:"md:hidden mb-4 flex justify-end items-center",children:e.jsxs("button",{onClick:()=>x(!0),className:"max-md:flex items-center gap-2 px-4 py-2 hidden border rounded-md bg-white shadow-sm",children:[e.jsx(B,{}),e.jsx("span",{children:"Filters"})]})}),e.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-50 z-50 transition-opacity duration-300 md:hidden ${g?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:v,children:e.jsxs("div",{className:`absolute bottom-0 left-0 right-0 bg-white rounded-t-xl transform transition-transform duration-300 ease-out ${g?"translate-y-0":"translate-y-full"}`,onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center border-b p-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Filters"}),e.jsx("button",{onClick:v,className:"p-1 rounded-full hover:bg-gray-100",children:e.jsx(T,{size:24})})]}),e.jsx("div",{className:"max-h-[70vh] overflow-y-auto p-4",children:e.jsx(k,{mainCategory:C(),onFilterChange:M,isMobile:!0,initialValues:t})}),e.jsxs("div",{className:"border-t p-4 flex gap-4",children:[e.jsx("button",{onClick:v,className:"flex-1 py-3 border border-gray-300 rounded-md text-center",children:"Cancel"}),e.jsx("button",{onClick:S,className:"flex-1 py-3 bg-black text-white rounded-md text-center",children:"Apply Filters"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[280px_1fr] gap-6 md:gap-8 items-start",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx(k,{mainCategory:C(),initialValues:t})}),e.jsxs("main",{className:"ml-0 md:ml-10 w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("div",{className:"text-sm text-gray-600",children:i==="loading"?"Loading...":`Showing ${l.length} products`}),e.jsxs("select",{className:"border px-3 py-1 rounded text-sm",value:t.sort,onChange:a=>r(j({sort:a.target.value,page:1})),children:[e.jsx("option",{value:"newest",children:"Newest"}),e.jsx("option",{value:"price_asc",children:"Price Low → High"}),e.jsx("option",{value:"price_desc",children:"Price High → Low"}),e.jsx("option",{value:"popularity",children:"Popular"}),e.jsx("option",{value:"rating",children:"Rating"})]})]}),i==="failed"&&e.jsx("div",{className:"text-red-500 text-sm mb-4",children:c}),l.length===0&&i!=="loading"&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-500 text-lg mb-4",children:(s==null?void 0:s.toLowerCase())==="all"?"Discover our complete collection of luxury products":"No products found matching your criteria"}),(s==null?void 0:s.toLowerCase())==="all"&&e.jsx("p",{className:"text-gray-400",children:"Browse through our carefully curated selection of jewellery and fragrances"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:l.map((a,u)=>e.jsx(H,{product:a},a.id||a._id||`p-${u}`))})]})]})]})]})};export{X as default};
