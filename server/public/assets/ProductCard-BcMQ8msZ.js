import{u as q,a as L,C as G,h as T,b as Y,ds as B,r as u,j as s,q as i,F as M,dt as Q,E as K,du as U,dv as X,dw as Z,dx as ee,ba as se,dy as ae}from"./index-CKwcYcCo.js";import{I as te}from"./index-CFYhMnPX.js";const re=({product:e,onAddToCart:R=()=>{},onQuickView:ie=()=>{},onToggleWishlist:_=()=>{}})=>{var I,S,A,F,D,O,E,H,W,$;const w=q(),N=L(G),o=T(),k=Y(),p=e._id||e.id,y=L(a=>B(a,p)),z=k.pathname.includes("/products/high-jewellery")||k.pathname.includes("/high-jewellery"),v=e.type==="high_jewellery"||e.type==="high-jewellery"||e.variants&&e.variants.some(a=>a.isPriceOnDemand)||e.isPriceOnDemand,l=v&&z,c=e.isOutOfStock||e.totalStock!==void 0&&e.totalStock===0||e.defaultVariant&&e.defaultVariant.stock===0||e.variants&&e.variants.length>0&&e.variants.every(a=>a.stock===0);let n=[];((I=e.category)==null?void 0:I.toLowerCase())==="jewellery"||l?n=e.colors||["#c79b3a","#d9d9d9","#e7b9a4"]:Array.isArray(e.colors)?n=e.colors:typeof e.colors=="string"&&(n=e.colors.split(",").map(a=>a.trim()));const[J,P]=u.useState(n.length?n[0]:null),[j,d]=u.useState(!1);if(u.useEffect(()=>{P(n.length?n[0]:null)},[n.join("|")]),!e)return null;(S=e==null?void 0:e.variants)==null||S.some(a=>a.isPriceOnDemand);const x=((A=e==null?void 0:e.defaultVariant)==null?void 0:A.price)??((D=(F=e==null?void 0:e.variants)==null?void 0:F[0])==null?void 0:D.price)??((O=e==null?void 0:e.priceRange)==null?void 0:O.min)??(e==null?void 0:e.price)??"—",f=v||x===0&&(e.type==="high_jewellery"||e.type==="high-jewellery")?"Price on Demand":typeof x=="number"?`₹${x.toLocaleString()}`:x,b=e.slug||e.productSlug||e.id||e._id,C=((E=e==null?void 0:e.heroImage)==null?void 0:E.url)||(e==null?void 0:e.heroImage)||((W=(H=e==null?void 0:e.gallery)==null?void 0:H[0])==null?void 0:W.url)||(($=e==null?void 0:e.gallery)==null?void 0:$[0])||"/placeholder.webp",V=()=>{o(b?`/product_details/${b}`:"/products")};return s.jsxs("article",{className:"ph-card group relative flex flex-col w-full pb-4 overflow-hidden transition-all duration-300 shadow-lg bg-white rounded-lg hover:shadow-xl",tabIndex:"0","aria-label":`${e.name||"Product"} - ${f}`,children:[l&&s.jsx("div",{className:"absolute top-3 left-3 z-10",children:s.jsx("span",{className:"bg-gradient-to-r from-yellow-400 to-yellow-600 text-black text-[1.0625rem] font-bold px-3 py-1 rounded-full shadow-md",children:"HIGH JEWELLERY"})}),s.jsxs("div",{onClick:V,className:"ph-image-wrap relative w-full h-64 overflow-hidden cursor-pointer rounded-t-lg",children:[s.jsx("img",{src:C,alt:e.name||"Product image",className:"ph-image w-full h-full object-cover transition-transform duration-500 group-hover:scale-105",loading:"lazy"}),c&&s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:s.jsx("span",{className:"bg-red-600 text-white px-3 py-1 rounded-md font-medium text-[1.0625rem]",children:"Out of Stock"})})]}),s.jsxs("div",{className:"ph-actions absolute right-0 top-4 flex flex-col gap-2 opacity-0 group-hover:opacity-100 transition-opacity md:transform md:translate-x-12 md:group-hover:translate-x-0 duration-300","aria-hidden":"true",children:[s.jsx("button",{className:`ph-action ph-action-ghost bg-white shadow-md rounded-full w-10 h-10 flex items-center justify-center transition-colors ${c||l?"opacity-50 cursor-not-allowed bg-gray-200 text-gray-400":"hover:bg-black hover:text-white"}`,title:l?"Contact for pricing":c?"Out of stock":"Add to cart","aria-label":l?"Contact for pricing":c?"Out of stock":"Add to cart",disabled:c||l,onClick:a=>{var g;if(a.stopPropagation(),l){i.error("Please contact us for high jewellery pricing and customization");return}if(c){i.error("This product is currently out of stock");return}if(!N){i.error("Please login to add items to cart"),o("/login");return}const t=((g=e.variants)==null?void 0:g[0])||e.defaultVariant,r={productId:e._id||e.id,variantId:t==null?void 0:t._id,variantSku:t==null?void 0:t.sku,quantity:1};if(!r.variantId&&!r.variantSku){i.error("Product variant information is missing");return}w(M(r)).unwrap().then(()=>{i.success("Item added to cart!")}).catch(m=>{var h;(h=m.message)!=null&&h.includes("Insufficient stock")?i.error(m.message):i.error("Failed to add item to cart"),console.error("Add to cart error:",m)}),R(e)},children:s.jsx(te,{className:"text-lg"})}),s.jsx("button",{className:"ph-action ph-action-ghost bg-white shadow-lg rounded-full w-11 h-11 flex items-center justify-center hover:bg-black hover:text-white transition-colors",title:y?"Remove from wishlist":"Add to wishlist","aria-label":y?"Remove from wishlist":"Add to wishlist",onClick:a=>{if(a.stopPropagation(),!N){i.error("Please login to manage wishlist"),o("/login");return}w(U(p)).unwrap().then(t=>{t.action==="added"?i.success("Added to wishlist!"):t.action==="removed"&&i.success("Removed from wishlist!")}).catch(t=>{var r,g,m,h;console.error("Wishlist error:",t),(r=t.message)!=null&&r.includes("Authentication failed")||(g=t.message)!=null&&g.includes("login again")?(i.error("Session expired. Please login again."),w(X()),o("/login")):(m=t.message)!=null&&m.includes("login")||(h=t.message)!=null&&h.includes("401")?(i.error("Please login to manage wishlist"),o("/login")):i.error("Failed to update wishlist")}),_({img:C,title:e.name,price:l?"Price on Demand":f,id:b})},children:y?s.jsx(Q,{className:"text-lg text-red-500"}):s.jsx(K,{className:"text-lg"})})]}),s.jsx("div",{className:"p-2 flex flex-col  flex-grow",children:e.type==="fragrance"||e.category==="fragrance"?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"text-[1.0625rem] uppercase tracking-wider text-gray-500 leading-0 font-medium ",children:e.type||"Fragrance"}),s.jsx("h3",{className:"text-base leading-none sm:text-lg font-playfair tracking-wide line-clamp-1 text-gray-900 ",children:e.name}),e.shortDescription&&s.jsx("p",{className:"text-[1.0625rem] text-gray-600 line-clamp-2 font-light  ",children:e.shortDescription}),s.jsx("div",{className:"text-base sm:text-lg font-medium  tracking-wide",children:f})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"text-[1.0625rem] uppercase leading-0 tracking-wider text-gray-500 font-medium ",children:l?"HIGH JEWELLERY":e.type||e.category||"jewellery"}),s.jsx("h3",{className:"text-base sm:text-lg font-playfair tracking-wide line-clamp-2 text-gray-900 leading-none",children:e.name}),l&&e.shortDescription&&s.jsx("p",{className:"text-[1.0625rem] text-gray-600 line-clamp-2 font-light  italic",children:e.shortDescription}),v?s.jsxs("div",{className:"flex flex-col gap-3 mt-auto",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"text-lg font-semibold tracking-wide bg-gradient-to-r from-amber-600 to-yellow-600 bg-clip-text text-transparent",children:"Price on Demand"}),s.jsx("div",{className:"h-1 w-8 bg-gradient-to-r from-yellow-400 to-amber-500 rounded-full"})]}),l&&s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:a=>{a.stopPropagation(),d(!j)},className:"w-full bg-gradient-to-r from-gray-900 to-black text-white px-4 py-2.5 text-[1.0625rem] font-medium rounded-lg hover:from-black hover:to-gray-800 transition-all duration-300 shadow-md hover:shadow-lg transform hover:scale-[1.02]",children:"Contact for Details"}),j&&s.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border border-gray-200 rounded-lg shadow-xl z-20 overflow-hidden",children:[s.jsxs("button",{onClick:a=>{a.stopPropagation(),ee(e,d)},className:"w-full flex items-center gap-3 px-4 py-3 text-[1.0625rem] text-left hover:bg-green-50 transition-colors border-b border-gray-100",children:[s.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:s.jsx(Z,{className:"text-white text-[1.0625rem]"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:"WhatsApp"}),s.jsx("div",{className:"text-[1.0625rem] text-gray-500",children:"Instant messaging"})]})]}),s.jsxs("button",{onClick:a=>{a.stopPropagation(),ae(e,d)},className:"w-full flex items-center gap-3 px-4 py-3 text-[1.0625rem] text-left hover:bg-blue-50 transition-colors",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:s.jsx(se,{className:"text-white text-[1.0625rem]"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:"Email"}),s.jsx("div",{className:"text-[1.0625rem] text-gray-500",children:"Detailed inquiry"})]})]})]})]})]}):s.jsx("div",{className:"text-base sm:text-lg font-medium tracking-wide mt-auto",children:f}),n.length>0&&s.jsx("div",{className:"flex flex-wrap items-start gap-2 ",children:n.map((a,t)=>s.jsx("button",{onClick:r=>{r.stopPropagation(),P(a)},className:`w-6 h-6 cursor-pointer rounded-full  transition-all ${J===a?"scale-110 shadow-md":" scale-100"}`,style:{backgroundColor:a||"#FFFFFF"},"aria-label":`Select ${a} color`,title:`Select ${a} color`},t))})]})}),j&&s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>d(!1)})]})};export{re as P};
